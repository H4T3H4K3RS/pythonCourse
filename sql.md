# Задание 1

1. Вывести список сотрудников, получающих зарплату больше, чем зарплата их непосредственного руководителя
```sql
SELECT e.ID, e.NAME, e.SALARY
FROM Employee e
WHERE e.SALARY > (SELECT s.SALARY FROM Employee s WHERE s.ID = e.CHIEF_ID);
```
Этот запрос выбирает идентификатор, имя и зарплату сотрудника из таблицы Employee, если зарплата сотрудника больше, чем зарплата его непосредственного руководителя. Это достигается путем использования подзапроса для выбора зарплаты руководителя с тем же ID, что и CHIEF_ID сотрудника, и сравнения ее с зарплатой сотрудника.

2. Вывести список сотрудников, получающих максимальную зарплату в своем отделе
```sql
SELECT e.ID, e.NAME, e.SALARY
FROM Employee e
WHERE e.SALARY = (
  SELECT MAX(SALARY)
  FROM Employee
  WHERE DEPARTMENT_ID = e.DEPARTMENT_ID
);
```
Этот запрос выбирает идентификатор, имя и зарплату сотрудника из таблицы Employee, если зарплата сотрудника равна максимальной зарплате в его отделе. Это достигается путем использования подзапроса для поиска максимальной зарплаты в том же отделе, что и сотрудник, а затем сравнения ее с зарплатой сотрудника.

3. Вывести список идентификаторов отделов, в которых работает не более 3 сотрудников
```sql
SELECT DEPARTMENT_ID
FROM Employee
GROUP BY DEPARTMENT_ID
HAVING COUNT(*) <= 3;
```
Этот запрос выбирает из таблицы Employee ID отдела, в котором число сотрудников отдела меньше или равно 3. Это достигается путем группировки данных по ID отдела, а затем фильтрации групп с количеством сотрудников меньше или равно 3 с помощью условия HAVING.

4. Выведите список таких сотрудников, у которых нет назначенного менеджера, работающего в том же отделе.
```sql
SELECT e.ID, e.NAME, e.DEPARTMENT_ID
FROM Employee e
WHERE e.CHIEF_ID IS NULL
  OR e.CHIEF_ID NOT IN (SELECT m.ID FROM Employee m WHERE m.DEPARTMENT_ID = e.DEPARTMENT_ID);
```
Этот запрос выбирает ID сотрудника, имя и ID отдела из таблицы Employee, если у сотрудника либо нет руководителя (т.е. его CHIEF_ID равен NULL), либо его руководитель не работает в том же отделе, что и он. Это достигается с помощью комбинации логических операторов и подзапросов для соответствующей фильтрации данных.

5. Найти список идентификаторов отделов с максимальной суммарной зарплатой сотрудников
```sql
SELECT e.DEPARTMENT_ID
FROM Employee e
GROUP BY e.DEPARTMENT_ID
HAVING SUM(e.SALARY) = (
  SELECT MAX(total_salary)
  FROM (
    SELECT DEPARTMENT_ID, SUM(SALARY) as total_salary
    FROM Employee
    GROUP BY DEPARTMENT_ID
  )
);
```
Этот запрос выбирает идентификатор отдела из таблицы Employee, где общая зарплата сотрудников отдела равна максимальной общей зарплате по всем отделам. Это достигается путем группировки данных по ID отдела, а затем фильтрации групп с общей зарплатой, равной максимальной общей зарплате по всем отделам, которая находится с помощью подзапроса, вычисляющего общую зарплату для каждого отдела и выбирающего максимальное значение.
